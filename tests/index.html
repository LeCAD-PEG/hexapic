<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://lecad-peg.github.io/hexapic/tests/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Tests - HEXAPIC</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Tests";
        var mkdocs_page_input_path = "tests.md";
        var mkdocs_page_url = "/hexapic/tests/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> HEXAPIC
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Overview</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../usage/">Usage</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../scaling/">Scaling</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="#">Tests</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#running-the-tests">Running the Tests</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#i-particle-pusher-verification">I. Particle Pusher Verification</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#1-multi-species-larmor-orbit-in-plane">1) Multi-Species Larmor Orbit (In-Plane)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#2-multi-species-larmor-orbit-out-of-plane-3v">2) Multi-Species Larmor Orbit (Out-of-Plane / 3V)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#3-eb-drift">3) E×B Drift</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#ii-field-solver-verification">II. Field Solver Verification</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#4-mixed-boundaries-capacitor-dirichlet-neumann">4) Mixed Boundaries (Capacitor / Dirichlet-Neumann)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#5-fully-open-boundaries-isolated-system">5) Fully Open Boundaries (Isolated System)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#6-closed-metal-box-all-dirichlet">6) Closed Metal Box (All-Dirichlet)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#7-periodic-boundaries">7) Periodic Boundaries</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#8-analytical-accuracy-greens-function">8) Analytical Accuracy (Green's Function)</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#iii-particle-mesh-coupling-verification">III. Particle-Mesh Coupling Verification</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#9-charge-deposition-potential-topology">9) Charge Deposition &amp; Potential Topology</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#10-field-interpolation-acceleration">10) Field Interpolation (Acceleration)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#11-self-force-stability-stationary-particle">11) Self-Force Stability (Stationary Particle)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#12-current-deposition-charge-conservation">12) Current Deposition (Charge Conservation)</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#output">Output</a>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../validation/">Validation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">API</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" >Files</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../api/files/">-- All --</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/collisions_8cpp/">collisions.cpp</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/diagnostics_8cpp/">diagnostics.cpp</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/domain__decomposition_8cpp/">domain_decomposition.cpp</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/field__solver__petsc_8cpp/">field_solver_petsc.cpp</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/main_8cpp/">main.cpp</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/particles_8cpp/">particles.cpp</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/plasma__wall_8cpp/">plasma_wall.cpp</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/read__input__file_8cpp/">read_input_file.cpp</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/volumetric__source_8cpp/">volumetric_source.cpp</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Classes</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../api/annotated/">-- All --</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/structBoundary/">Boundary</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/structCell/">Cell</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/structCollision/">Collision</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/structGrid/">Grid</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/structNeighbours/">Neighbours</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/structParticle/">Particle</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/structSecondaryEmission/">SecondaryEmission</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/structSource/">Source</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/structSourceSpecie/">SourceSpecie</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/structSpecies/">Species</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/structSpecies__inject/">Species_inject</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/structSpecies__load/">Species_load</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../api/functions/">All Functions</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">HEXAPIC</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Tests</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/LeCAD-PEG/HEXAPIC.git/edit/master/docs/tests.md">Edit on HEXAPIC</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="physics-validation-tests">Physics Validation Tests<a class="headerlink" href="#physics-validation-tests" title="Permanent link">&para;</a></h1>
<h2 id="running-the-tests">Running the Tests<a class="headerlink" href="#running-the-tests" title="Permanent link">&para;</a></h2>
<p>Tests are run with <code>bash run_physics_validation.slm</code> (or <code>sbatch</code> on HPC); use <code>--particle-pusher</code>, <code>--field-solver</code>, <code>--particle-mesh-coupling</code>, or <code>--all</code> to choose groups. On first run the script creates a local <code>.venv</code> in this directory and installs dependencies from <code>requirements.txt</code> (numpy, openpmd-api); later runs reuse that venv. The HEXAPIC executable needs <code>libopenPMD.so</code> at runtime — the script sets <code>LD_LIBRARY_PATH</code> from <code>OPENPMD_ROOT</code> (default <code>../openpmd</code> relative to the repo); override with <code>export OPENPMD_ROOT=/path/to/openpmd</code> if your openPMD install is elsewhere.</p>
<hr />
<h2 id="i-particle-pusher-verification">I. Particle Pusher Verification<a class="headerlink" href="#i-particle-pusher-verification" title="Permanent link">&para;</a></h2>
<p><em>These tests verify the Boris integrator and 3V vector logic. Maxwell solver and Deposition are disabled (<code>FieldSolverFlag = 0</code>).</em></p>
<p><em><strong>Threshold framework:</strong> All thresholds are adaptive, computed as</em></p>
<div class="arithmatex">\[
\text{threshold} = K \times (\text{physics\_err} + \text{float\_err})
\]</div>
<p><em>where <span class="arithmatex">\(K=10\)</span> is a safety factor. Physics error captures Boris integrator <span class="arithmatex">\(O(\Delta t^2)\)</span> phase drift, and float error captures <span class="arithmatex">\(O(\epsilon_m \sqrt{N})\)</span> accumulation over <span class="arithmatex">\(N\)</span> output steps (<span class="arithmatex">\(\epsilon_m \approx 2.22 \times 10^{-16}\)</span>).</em></p>
<h3 id="1-multi-species-larmor-orbit-in-plane">1) Multi-Species Larmor Orbit (In-Plane)<a class="headerlink" href="#1-multi-species-larmor-orbit-in-plane" title="Permanent link">&para;</a></h3>
<p><strong>Description:</strong> Verifies basic cyclotron rotation in the simulation plane (x, y) and charge sign handling using an electron–positron pair.</p>
<ul>
<li><strong>Field E:</strong> Disabled</li>
<li><strong>Field B:</strong> <span class="arithmatex">\(B=(0,\,0,\,0.1)\)</span> T</li>
<li>
<p><strong>Particles:</strong></p>
<ul>
<li><strong>Species 1 (e−):</strong> <span class="arithmatex">\(q=-e,\; m=m_e,\; v_0=(10^6,\; -8794,\; 0)\)</span> m/s</li>
<li><strong>Species 2 (e+):</strong> <span class="arithmatex">\(q=+e,\; m=m_e,\; v_0=(10^6,\; +8794,\; 0)\)</span> m/s</li>
</ul>
<p><em>(The non-zero <span class="arithmatex">\(v_y\)</span> is the Boris half-step back correction: <span class="arithmatex">\(v_y \approx \mp v_\perp \omega_c \Delta t / 2\)</span>.)</em></p>
</li>
<li>
<p><strong>Simulation Time:</strong> <span class="arithmatex">\(\Delta t = 10^{-12}\)</span> s, <span class="arithmatex">\(T_{\text{total}}= 3 \times T_{\text{Larmor}}\)</span>. Only the last 1/3 of output steps is analyzed (initial transient skipped).</p>
</li>
<li>
<p><strong>Metrics &amp; Pass Criteria:</strong></p>
<ol>
<li>
<p><strong>Energy Conservation (Absolute):</strong></p>
<div class="arithmatex">\[
\epsilon_E = \max|E_k(t)-E_k(0)|, \quad E_k = \tfrac{1}{2}m(v_x^2+v_y^2+v_z^2)
\]</div>
<p><strong>Pass if:</strong> <span class="arithmatex">\(\epsilon_E &lt; K \cdot \epsilon_m \cdot \sqrt{N}\)</span></p>
</li>
<li>
<p><strong>4-Radius Separation:</strong></p>
<div class="arithmatex">\[
\Delta_{\text{sep}} = \max_t \left|\mathbf{x}_{e^-}(t) - \mathbf{x}_{e^+}(t)\right|
\]</div>
<p>Expected <span class="arithmatex">\(4 R_L\)</span> where <span class="arithmatex">\(R_L = \dfrac{m\, v_\perp}{|q|\, B_0}\)</span>.</p>
<p><strong>Pass if:</strong></p>
<div class="arithmatex">\[
|\Delta_{\text{sep}} - 4 R_L| &lt; K \cdot \!\left(4 R_L \cdot \frac{20(\omega_c \Delta t)^2}{12} + 4 R_L \cdot \epsilon_m \sqrt{N}\right)
\]</div>
</li>
<li>
<p><strong>Y-Projection Trajectory:</strong></p>
<div class="arithmatex">\[
\text{Extent} = \bigl(\max(y) - \min(y)\bigr) \cdot \Delta y
\]</div>
<p>Expected <span class="arithmatex">\(2 R_L\)</span>.</p>
<p><strong>Pass if:</strong></p>
<div class="arithmatex">\[
|\text{extent} - 2 R_L| &lt; K \cdot \!\left(2 R_L \cdot \frac{10(\omega_c \Delta t)^2}{12} + 2 R_L \cdot \epsilon_m \sqrt{N}\right)
\]</div>
</li>
<li>
<p><strong>Z-Axis Stability:</strong></p>
<div class="arithmatex">\[
\Delta z = \max|z(t)-z(0)|
\]</div>
<p><strong>Pass if:</strong> <span class="arithmatex">\(\Delta z &lt; K \cdot R_L \cdot \epsilon_m \cdot \sqrt{N}\)</span></p>
</li>
</ol>
</li>
</ul>
<h3 id="2-multi-species-larmor-orbit-out-of-plane-3v">2) Multi-Species Larmor Orbit (Out-of-Plane / 3V)<a class="headerlink" href="#2-multi-species-larmor-orbit-out-of-plane-3v" title="Permanent link">&para;</a></h3>
<p><strong>Description:</strong> Verifies the coupling between the spatial grid (x) and the virtual velocity component (<span class="arithmatex">\(v_z\)</span>) using a <span class="arithmatex">\(B_y\)</span> field. Only the electron trajectory is analyzed.</p>
<ul>
<li><strong>Field E:</strong> Disabled</li>
<li><strong>Field B:</strong> <span class="arithmatex">\(B=(0,\,0.1,\,0)\)</span> T</li>
<li><strong>Particles:</strong><ul>
<li><strong>Species 1 (e−) &amp; Species 2 (e+):</strong> <span class="arithmatex">\(v_0=(0,\;0,\;10^6)\)</span> m/s</li>
</ul>
</li>
<li>
<p><strong>Simulation Time:</strong> <span class="arithmatex">\(\Delta t = 10^{-12}\)</span> s, <span class="arithmatex">\(T_{\text{total}}= 3 \times T_{\text{Larmor}}\)</span>. Only the last 1/3 of output steps is analyzed.</p>
</li>
<li>
<p><strong>Metrics &amp; Pass Criteria:</strong></p>
<ol>
<li>
<p><strong>Energy Conservation (Absolute):</strong></p>
<div class="arithmatex">\[
\epsilon_E = \max|E_k(t)-E_k(0)|
\]</div>
<p><strong>Pass if:</strong> <span class="arithmatex">\(\epsilon_E &lt; K \cdot \epsilon_m \cdot \sqrt{N}\)</span></p>
</li>
<li>
<p><strong>X-Projection Trajectory:</strong></p>
<div class="arithmatex">\[
\text{Extent} = \bigl(\max(x) - \min(x)\bigr) \cdot \Delta x
\]</div>
<p>Expected <span class="arithmatex">\(2 R_L\)</span>.</p>
<p><strong>Pass if:</strong></p>
<div class="arithmatex">\[
|\text{extent} - 2 R_L| &lt; K \cdot \!\left(2 R_L \cdot \frac{10(\omega_c \Delta t)^2}{12} + 2 R_L \cdot \epsilon_m \sqrt{N}\right)
\]</div>
</li>
<li>
<p><strong>Y-Axis Stability:</strong></p>
<div class="arithmatex">\[
\Delta y = \max|y(t)-y(0)|
\]</div>
<p><strong>Pass if:</strong> <span class="arithmatex">\(\Delta y &lt; K \cdot R_L \cdot \epsilon_m \cdot \sqrt{N}\)</span></p>
</li>
</ol>
</li>
</ul>
<h3 id="3-eb-drift">3) E×B Drift<a class="headerlink" href="#3-eb-drift" title="Permanent link">&para;</a></h3>
<p><strong>Description:</strong> Verifies the Lorentz force combination by creating a drift along the Y-axis via crossed E and B fields.</p>
<ul>
<li><strong>Field E:</strong> From boundary potentials: <span class="arithmatex">\(V=0\)</span> at <span class="arithmatex">\(x=0\)</span>, <span class="arithmatex">\(V=100\)</span> V at <span class="arithmatex">\(x=L_x=0.01\)</span> m. Gives <span class="arithmatex">\(E_x = -10^4\)</span> V/m.</li>
<li><strong>Field B:</strong> <span class="arithmatex">\(B=(0,\,0,\,0.1)\)</span> T</li>
<li><strong>Particles:</strong><ul>
<li><strong>Species 1 (e−):</strong> <span class="arithmatex">\(v_0=(0,\; 10^5,\; 0)\)</span> m/s. Placed at domain center.</li>
</ul>
</li>
<li>
<p><strong>Simulation Time:</strong> <span class="arithmatex">\(\Delta t = 10^{-11}\)</span> s, 400 steps, output every 20 steps.</p>
</li>
<li>
<p><strong>Metrics &amp; Pass Criteria:</strong></p>
<ol>
<li>
<p><strong>Hamiltonian Conservation:</strong></p>
<div class="arithmatex">\[
H = \tfrac{1}{2}m|\mathbf{v}|^2 + q\phi
\]</div>
<p>where <span class="arithmatex">\(\phi = -E_x \cdot x\)</span>.</p>
<p><strong>Pass if:</strong></p>
<div class="arithmatex">\[
\max|H(t) - H(0)| &lt; K \cdot \!\left(|H_0| \cdot \frac{(\omega_c \Delta t)^2}{8} + |H_0| \cdot \epsilon_m \sqrt{N}\right)
\]</div>
</li>
<li>
<p><strong>Drift Velocity (Y):</strong> Mean <span class="arithmatex">\(v_y\)</span> over the second half of the simulation, expected <span class="arithmatex">\(v_{\text{drift}} = -E_x / B_z\)</span>.</p>
<p><strong>Pass if:</strong></p>
<div class="arithmatex">\[
|\bar{v}_y - v_{\text{drift}}| &lt; K \cdot \!\left(|v_{\text{drift}}| \cdot \frac{(\omega_c \Delta t)^2}{8} + |v_{\text{drift}}| \cdot \epsilon_m \sqrt{N}\right)
\]</div>
</li>
</ol>
</li>
</ul>
<hr />
<h2 id="ii-field-solver-verification">II. Field Solver Verification<a class="headerlink" href="#ii-field-solver-verification" title="Permanent link">&para;</a></h2>
<p><em>These tests verify the Poisson solver logic</em></p>
<div class="arithmatex">\[
\nabla^2\phi = -\frac{\rho}{\epsilon_0}
\]</div>
<p><em>and boundary condition implementation. The solver uses an iterative method with target relative residual <span class="arithmatex">\(\text{rtol} \sim 10^{-6}\)</span>.</em></p>
<p><em><strong>Threshold framework:</strong> Thresholds combine solver residual error (<span class="arithmatex">\(O(\text{rtol})\)</span>), floating point accumulation (<span class="arithmatex">\(O(\epsilon_m \sqrt{N_{\text{cells}}})\)</span>), and grid truncation error (<span class="arithmatex">\(O(1/N)\)</span>), scaled by safety factor <span class="arithmatex">\(K=10\)</span>.</em></p>
<h3 id="4-mixed-boundaries-capacitor-dirichlet-neumann">4) Mixed Boundaries (Capacitor / Dirichlet-Neumann)<a class="headerlink" href="#4-mixed-boundaries-capacitor-dirichlet-neumann" title="Permanent link">&para;</a></h3>
<p><strong>Description:</strong> Verifies the transition between fixed potential (electrodes) and open space (dielectric). Simulates a finite parallel-plate capacitor.</p>
<ul>
<li><strong>Domain:</strong> <span class="arithmatex">\(32 \times 32\)</span> grid, <span class="arithmatex">\(L = 0.001\)</span> m</li>
<li><strong>Boundary Conditions:</strong><ul>
<li><strong>Y-Axis (Electrodes):</strong> <span class="arithmatex">\(\phi(x, 0) = -10\)</span> V, <span class="arithmatex">\(\phi(x, L_y) = +10\)</span> V (Dirichlet)</li>
<li><strong>X-Axis (Open):</strong> <span class="arithmatex">\(\dfrac{\partial \phi}{\partial x} = 0\)</span> at <span class="arithmatex">\(x=0,\, x=L_x\)</span> (Neumann / Dielectric)</li>
</ul>
</li>
<li>
<p><strong>Source:</strong> No particles (vacuum solve)</p>
</li>
<li>
<p><strong>Metrics &amp; Pass Criteria:</strong></p>
<ol>
<li>
<p><strong>Boundary Value Integrity:</strong></p>
<div class="arithmatex">\[
\epsilon_{\text{BC}} = \max\!\bigl(|\phi_{y=0} - (-10)|,\; |\phi_{y=L_y} - 10|\bigr)
\]</div>
<p><strong>Pass if:</strong> <span class="arithmatex">\(\epsilon_{\text{BC}} &lt; K \cdot \epsilon_m \cdot V_0\)</span></p>
</li>
<li>
<p><strong>Field Uniformity (Interior):</strong> Standard deviation of <span class="arithmatex">\(E_y\)</span> in the interior (excluding 2-cell border near Neumann/Dirichlet corners).</p>
<p><strong>Pass if:</strong></p>
<div class="arithmatex">\[
\sigma(E_y) &lt; K \cdot \!\left(|\bar{E}_y| \cdot \text{rtol} + |\bar{E}_y| \cdot \epsilon_m \sqrt{N_{\text{cells}}}\right)
\]</div>
</li>
</ol>
</li>
</ul>
<h3 id="5-fully-open-boundaries-isolated-system">5) Fully Open Boundaries (Isolated System)<a class="headerlink" href="#5-fully-open-boundaries-isolated-system" title="Permanent link">&para;</a></h3>
<p><strong>Description:</strong> Verifies solver stability for a floating potential system using all-Neumann boundaries. Uses a neutral dipole to ensure <span class="arithmatex">\(\int \rho \, dV = 0\)</span>.</p>
<ul>
<li><strong>Domain:</strong> <span class="arithmatex">\(32 \times 32\)</span> grid, <span class="arithmatex">\(L = 0.001\)</span> m</li>
<li><strong>Boundary Conditions:</strong><ul>
<li><strong>All boundaries:</strong> <span class="arithmatex">\(\dfrac{\partial \phi}{\partial n} = 0\)</span> (Neumann everywhere)</li>
</ul>
</li>
<li>
<p><strong>Source:</strong> Neutral Dipole — electron cloud at <span class="arithmatex">\(x \approx 0.35\, L\)</span>, positron cloud at <span class="arithmatex">\(x \approx 0.65\, L\)</span>.</p>
</li>
<li>
<p><strong>Metrics &amp; Pass Criteria:</strong></p>
<ol>
<li>
<p><strong>Boundary Flux Leakage:</strong> Maximum of mean <span class="arithmatex">\(|E_n|\)</span> across all four boundaries.</p>
<p><strong>Pass if:</strong></p>
<div class="arithmatex">\[
\max\!\bigl(\overline{|E_x|}_{\text{walls}},\; \overline{|E_y|}_{\text{walls}}\bigr) &lt; K \cdot \!\left(E_{\text{scale}} \cdot \text{rtol} + E_{\text{scale}} \cdot \epsilon_m \sqrt{N} + \frac{E_{\text{scale}}}{N_{\min}}\right)
\]</div>
<p>where <span class="arithmatex">\(E_{\text{scale}} = \max|\mathbf{E}|\)</span> over the domain, <span class="arithmatex">\(N_{\min} = \min(N_x, N_y)\)</span>.</p>
</li>
</ol>
</li>
</ul>
<h3 id="6-closed-metal-box-all-dirichlet">6) Closed Metal Box (All-Dirichlet)<a class="headerlink" href="#6-closed-metal-box-all-dirichlet" title="Permanent link">&para;</a></h3>
<p><strong>Description:</strong> Verifies the basic "grounded box" scenario. Tests solver matrix construction and solution symmetry.</p>
<ul>
<li><strong>Domain:</strong> <span class="arithmatex">\(32 \times 32\)</span> grid, <span class="arithmatex">\(L = 0.001\)</span> m</li>
<li><strong>Boundary Conditions:</strong><ul>
<li><strong>All boundaries:</strong> <span class="arithmatex">\(\phi = 0\)</span> (Ground)</li>
</ul>
</li>
<li>
<p><strong>Source:</strong> Electron charge cloud centered at <span class="arithmatex">\((L_x/2,\, L_y/2)\)</span>.</p>
</li>
<li>
<p><strong>Metrics &amp; Pass Criteria:</strong></p>
<ol>
<li>
<p><strong>Boundary Zero Check:</strong></p>
<div class="arithmatex">\[
\epsilon_{\text{wall}} = \max_{\text{all boundaries}} |\phi|
\]</div>
<p><strong>Pass if:</strong> <span class="arithmatex">\(\epsilon_{\text{wall}} &lt; K \cdot \epsilon_m \cdot \max(|\phi_{\text{boundary}}|, 1)\)</span></p>
</li>
<li>
<p><strong>Symmetry:</strong></p>
<div class="arithmatex">\[
\epsilon_{\text{sym}} = P_{99.9}\!\bigl(|\phi(x,y) - \phi(L_x-x,\, L_y-y)|\bigr)
\]</div>
<p>over interior points (excluding 2-cell border and 3-cell radius around center singularity).</p>
<p><strong>Pass if:</strong></p>
<div class="arithmatex">\[
\epsilon_{\text{sym}} &lt; K \cdot \!\left(V_{\text{scale}} \cdot \text{rtol} + V_{\text{scale}} \cdot \epsilon_m \sqrt{N} + \frac{V_{\text{scale}}}{N^{1.5}}\right)
\]</div>
</li>
</ol>
</li>
</ul>
<h3 id="7-periodic-boundaries">7) Periodic Boundaries<a class="headerlink" href="#7-periodic-boundaries" title="Permanent link">&para;</a></h3>
<p><strong>Description:</strong> Verifies matrix topology connectivity. Signals leaving the right boundary must wrap to the left boundary. Periodic in X direction with Neumann in Y.</p>
<ul>
<li><strong>Domain:</strong> <span class="arithmatex">\(32 \times 32\)</span> grid, <span class="arithmatex">\(L = 0.001\)</span> m</li>
<li><strong>Boundary Conditions:</strong><ul>
<li><strong>X-Axis:</strong> <span class="arithmatex">\(\phi(0, y) = \phi(L_x, y)\)</span> (Periodic, <code>PeriodicFlagX1 = 1</code>)</li>
<li><strong>Y-Axis:</strong> <span class="arithmatex">\(\dfrac{\partial \phi}{\partial y} = 0\)</span> (Neumann)</li>
</ul>
</li>
<li>
<p><strong>Source:</strong> Neutral dipole — electron and positron clouds at symmetric x-positions.</p>
</li>
<li>
<p><strong>Metrics &amp; Pass Criteria:</strong></p>
<ol>
<li>
<p><strong>Periodicity (Derivative Continuity):</strong> Checks that the first derivative of <span class="arithmatex">\(\phi\)</span> is continuous across the periodic boundary (left–right wrap-around). Automatically detects whether the solver duplicates the endpoint (<span class="arithmatex">\(\phi[0] = \phi[N_x]\)</span>) or not.</p>
<p><strong>Pass if:</strong></p>
<div class="arithmatex">\[
\text{derivative jump} &lt; K \cdot \!\left(\text{max internal curvature} + V_{\text{range}} \cdot \text{rtol} + V_{\text{range}} \cdot \epsilon_m \sqrt{N}\right)
\]</div>
</li>
</ol>
</li>
</ul>
<h3 id="8-analytical-accuracy-greens-function">8) Analytical Accuracy (Green's Function)<a class="headerlink" href="#8-analytical-accuracy-greens-function" title="Permanent link">&para;</a></h3>
<p><strong>Description:</strong> Quantifies numerical error by comparing the grid solution to the analytical <span class="arithmatex">\(\ln(r)\)</span> profile for a 2D point charge.</p>
<ul>
<li><strong>Domain:</strong> <span class="arithmatex">\(64 \times 64\)</span> grid, <span class="arithmatex">\(L = 0.001\)</span> m</li>
<li><strong>Boundary Conditions:</strong> All Dirichlet <span class="arithmatex">\(\phi = 0\)</span>.</li>
<li><strong>Source:</strong> Electron charge cloud at center <span class="arithmatex">\((L_x/2,\, L_y/2)\)</span>.</li>
<li>
<p><strong>Comparison:</strong> Fit <span class="arithmatex">\(\phi_{\text{num}}(r)\)</span> to <span class="arithmatex">\(A \ln(r) + B\)</span> via linear regression in the annular region <span class="arithmatex">\(3\Delta x &lt; r &lt; 0.35 \min(L_x, L_y)\)</span>.</p>
</li>
<li>
<p><strong>Metrics &amp; Pass Criteria:</strong></p>
<ol>
<li>
<p><strong>Analytical Fit (<span class="arithmatex">\(1 - R^2\)</span>):</strong> Coefficient of determination for <span class="arithmatex">\(\phi\)</span> vs <span class="arithmatex">\(\ln(r)\)</span> regression. Measures how well the numerical potential follows the expected logarithmic profile.</p>
<p><strong>Pass if:</strong></p>
<div class="arithmatex">\[
1 - R^2 &lt; K \cdot \!\left((\Delta x / r_{\min})^2 + 100 \cdot \epsilon_m\right)
\]</div>
</li>
</ol>
</li>
</ul>
<hr />
<h2 id="iii-particle-mesh-coupling-verification">III. Particle-Mesh Coupling Verification<a class="headerlink" href="#iii-particle-mesh-coupling-verification" title="Permanent link">&para;</a></h2>
<p><em>These tests verify the projection of particle quantities to the grid (Deposition) and the sampling of grid fields to the particle (Interpolation/Gathering).</em></p>
<p><em><strong>Threshold framework:</strong> All thresholds are adaptive, computed as</em></p>
<div class="arithmatex">\[
\text{threshold} = K \times (\text{physics\_err} + \text{float\_err})
\]</div>
<p><em>where <span class="arithmatex">\(K=10\)</span> is a safety factor. Physics error captures solver residual (<span class="arithmatex">\(O(\text{rtol})\)</span>), discretization (<span class="arithmatex">\(O(\Delta x^2)\)</span>), and CIC shape-function effects. Float error captures <span class="arithmatex">\(O(\epsilon_m \sqrt{N})\)</span> accumulation (<span class="arithmatex">\(\epsilon_m \approx 2.22 \times 10^{-16}\)</span>). Grid charge is inferred via Gauss's law:</em></p>
<div class="arithmatex">\[
Q_{\text{grid}} = -\epsilon_0 \sum_{\text{interior}} (\nabla^2 \phi)_{i,j}\, \Delta x \, \Delta y
\]</div>
<h3 id="9-charge-deposition-potential-topology">9) Charge Deposition &amp; Potential Topology<a class="headerlink" href="#9-charge-deposition-potential-topology" title="Permanent link">&para;</a></h3>
<p><strong>Description:</strong> Verifies that deposited charge creates a quantitatively correct and symmetric potential well. Ensures coupling between CIC particle weighting and the Poisson solver, and that physical constants (<span class="arithmatex">\(\epsilon_0\)</span>) are correctly applied.</p>
<ul>
<li><strong>Domain:</strong> <span class="arithmatex">\(32 \times 32\)</span> grid, <span class="arithmatex">\(L = 0.001\)</span> m, All-Dirichlet (<span class="arithmatex">\(\phi = 0\)</span>).</li>
<li><strong>Source:</strong> Charge cloud at center <span class="arithmatex">\((L_x/2,\, L_y/2)\)</span>. Total charge <span class="arithmatex">\(Q_{\text{total}} = -q_e \cdot n \cdot \Delta x \cdot \Delta y\)</span> where <span class="arithmatex">\(n = 2.1 \times 10^{15}\)</span> m<span class="arithmatex">\(^{-3}\)</span> (from <code>static_deposit.inp</code>).</li>
<li>
<p><strong>Simulation:</strong> 5 steps, <span class="arithmatex">\(\Delta t = 10^{-12}\)</span> s. Field read from final iteration.</p>
</li>
<li>
<p><strong>Metrics &amp; Pass Criteria:</strong></p>
<ol>
<li>
<p><strong>Integrated Charge Conservation:</strong></p>
<div class="arithmatex">\[
\epsilon_Q = |Q_{\text{grid}} - Q_{\text{total}}|
\]</div>
<p><strong>Pass if:</strong></p>
<div class="arithmatex">\[
\epsilon_Q &lt; K \cdot |Q_{\text{total}}| \cdot \!\left(\text{rtol} + \frac{1}{N} + \epsilon_m \sqrt{N_{\text{cells}}}\right)
\]</div>
<p><em>(Combines solver residual, <span class="arithmatex">\(O(1/N)\)</span> Laplacian discretization error, and float accumulation.)</em></p>
</li>
<li>
<p><strong>Symmetry:</strong></p>
<div class="arithmatex">\[
\epsilon_{\text{sym}} = P_{99.9}\!\bigl(|\phi(x,y) - \phi(L_x-x,\, L_y-y)|\bigr)
\]</div>
<p>over interior points (excluding 2-cell border and 3-cell radius around center singularity).</p>
<p><strong>Pass if:</strong></p>
<div class="arithmatex">\[
\epsilon_{\text{sym}} &lt; K \cdot V_{\text{scale}} \cdot \!\left(\text{rtol} + \epsilon_m \sqrt{N_{\text{pts}}} + \frac{1}{N_{\text{grid}}}\right)
\]</div>
<p><em>(Combines solver residual, float accumulation, and <span class="arithmatex">\(O(1/N)\)</span> grid discretization asymmetry from CIC and Laplacian.)</em></p>
</li>
<li>
<p><strong>L2 Profile Error:</strong> Relative RMS between simulated <span class="arithmatex">\(\phi\)</span> and analytic Green's function <span class="arithmatex">\(\phi_{\text{ana}}\)</span> (2D Fourier series for point charge in grounded box, 50 modes).</p>
<p><strong>Pass if:</strong></p>
<div class="arithmatex">\[
\sqrt{\frac{\sum (\phi - \phi_{\text{ana}})^2}{\sum \phi_{\text{ana}}^2}} &lt; K \cdot \!\left(\text{rtol} + \frac{1}{N_{\text{grid}}} + \epsilon_m \sqrt{N_{\text{pts}}}\right)
\]</div>
<p><em>(Combines solver residual, <span class="arithmatex">\(O(1/N)\)</span> Fourier truncation and grid discretization error, and float accumulation.)</em></p>
</li>
</ol>
</li>
</ul>
<h3 id="10-field-interpolation-acceleration">10) Field Interpolation (Acceleration)<a class="headerlink" href="#10-field-interpolation-acceleration" title="Permanent link">&para;</a></h3>
<p><strong>Description:</strong> Verifies that a particle in a uniform E-field experiences the correct Lorentz acceleration <span class="arithmatex">\(a = qE/m\)</span> by measuring velocity change over multiple timesteps.</p>
<ul>
<li><strong>Domain:</strong> <span class="arithmatex">\(32 \times 32\)</span> grid, <span class="arithmatex">\(L_y\)</span> from input file (default <span class="arithmatex">\(L = 0.001\)</span> m).</li>
<li><strong>Boundary Conditions:</strong><ul>
<li><strong>Y-Axis (Electrodes):</strong> <span class="arithmatex">\(\phi(x, 0) = -10\)</span> V, <span class="arithmatex">\(\phi(x, L_y) = +10\)</span> V (Dirichlet)</li>
<li><strong>X-Axis (Open):</strong> <span class="arithmatex">\(\dfrac{\partial \phi}{\partial x} = 0\)</span> (Neumann / Dielectric)</li>
</ul>
</li>
<li><strong>Particle:</strong> Single electron (<span class="arithmatex">\(q = -e\)</span>, <span class="arithmatex">\(m = m_e\)</span>) at center, <span class="arithmatex">\(v_0 = 0\)</span>.</li>
<li>
<p><strong>Simulation:</strong> 20 steps, <span class="arithmatex">\(\Delta t = 10^{-12}\)</span> s, output every step.</p>
</li>
<li>
<p><strong>Metrics &amp; Pass Criteria:</strong></p>
<ol>
<li>
<p><strong>Acceleration Accuracy:</strong> Linear fit <span class="arithmatex">\(v_y(t) = a_{\text{meas}} \cdot t + v_0\)</span> gives measured acceleration.</p>
<p>Expected: <span class="arithmatex">\(a_{\text{expected}} = \dfrac{q\, E_y}{m}\)</span> where <span class="arithmatex">\(E_y = -(V_{\text{top}} - V_{\text{bot}}) / L_y\)</span>.</p>
<p><strong>Pass if:</strong></p>
<div class="arithmatex">\[
|a_{\text{meas}} - a_{\text{expected}}| &lt; K \cdot |a_{\text{expected}}| \cdot \!\left(\text{rtol} + \frac{1}{N_{\text{grid}}} + \epsilon_m \sqrt{N_{\text{pts}}}\right)
\]</div>
<p><em>(Combines solver residual, <span class="arithmatex">\(O(1/N)\)</span> grid error from CIC and finite-difference E, and float accumulation in the linear fit.)</em></p>
</li>
</ol>
</li>
</ul>
<h3 id="11-self-force-stability-stationary-particle">11) Self-Force Stability (Stationary Particle)<a class="headerlink" href="#11-self-force-stability-stationary-particle" title="Permanent link">&para;</a></h3>
<p><strong>Description:</strong> Integration test for the full PIC loop: Deposit <span class="arithmatex">\(\rho\)</span> → Solve Poisson → Interpolate <span class="arithmatex">\(\mathbf{E}\)</span> → Push. A stationary particle at the center of a symmetric grounded box should feel near-zero net force; any displacement is parasitic (self-force).</p>
<ul>
<li><strong>Domain:</strong> <span class="arithmatex">\(32 \times 32\)</span> grid, <span class="arithmatex">\(L = 0.001\)</span> m, All-Dirichlet (<span class="arithmatex">\(\phi = 0\)</span>).</li>
<li><strong>Particle:</strong> Single electron at rest (<span class="arithmatex">\(v_0 = 0\)</span>) centered at <span class="arithmatex">\((L_x/2,\, L_y/2)\)</span>.</li>
<li>
<p><strong>Simulation:</strong> 20 steps, <span class="arithmatex">\(\Delta t = 10^{-12}\)</span> s, output every step.</p>
</li>
<li>
<p><strong>Metrics &amp; Pass Criteria:</strong></p>
<ol>
<li>
<p><strong>Parasitic Displacement:</strong></p>
<div class="arithmatex">\[
\Delta r = \sqrt{(x_{\text{final}} - x_0)^2 + (y_{\text{final}} - y_0)^2}
\]</div>
<p><strong>Pass if:</strong></p>
<div class="arithmatex">\[
\Delta r &lt; K \cdot \!\left(N_{\text{steps}} \cdot \Delta x + \epsilon_m \cdot \Delta x \cdot \sqrt{N_{\text{steps}}}\right)
\]</div>
<p><em>(PIC codes exhibit parasitic motion from CIC shape asymmetry, field gradient noise, and pusher-solver coupling. Threshold is grid-based: displacement bounded by <span class="arithmatex">\(O(N \cdot \Delta x)\)</span> over the simulation.)</em></p>
</li>
</ol>
</li>
</ul>
<h3 id="12-current-deposition-charge-conservation">12) Current Deposition (Charge Conservation)<a class="headerlink" href="#12-current-deposition-charge-conservation" title="Permanent link">&para;</a></h3>
<p><strong>Description:</strong> Verifies that moving a particle and re-depositing charge conserves total charge on the grid. This ensures Gauss's law (<span class="arithmatex">\(\nabla \cdot \mathbf{E} = \rho / \epsilon_0\)</span>) holds at every timestep, critical for Esirkepov-type current deposition schemes.</p>
<ul>
<li><strong>Domain:</strong> <span class="arithmatex">\(32 \times 32\)</span> grid, <span class="arithmatex">\(L = 0.001\)</span> m, All-Dirichlet (<span class="arithmatex">\(\phi = 0\)</span>).</li>
<li><strong>Particle:</strong> Single electron with <span class="arithmatex">\(v_x = 10^4\)</span> m/s (traverses <span class="arithmatex">\({\sim}\,0.2\)</span> cells over 10 steps).</li>
<li>
<p><strong>Simulation:</strong> 10 steps, <span class="arithmatex">\(\Delta t = 10^{-12}\)</span> s, output every step. Poisson solver active (<code>FieldSolverFlag = 1</code>).</p>
</li>
<li>
<p><strong>Metrics &amp; Pass Criteria:</strong></p>
<ol>
<li>
<p><strong>Charge Conservation (Gauss):</strong></p>
<div class="arithmatex">\[
\Delta Q = |Q_{\text{grid}}(t_{\text{final}}) - Q_{\text{grid}}(t_0)|
\]</div>
<p>where <span class="arithmatex">\(Q_{\text{grid}}\)</span> is computed via discrete Laplacian of <span class="arithmatex">\(\phi\)</span>.</p>
<p><strong>Pass if:</strong></p>
<div class="arithmatex">\[
\Delta Q &lt; K \cdot |Q| \cdot \!\left(\text{rtol} + \epsilon_m \sqrt{N_{\text{cells}}} + \frac{1}{N}\right)
\]</div>
<p><em>(Combines solver residual at two iterations, float accumulation, and <span class="arithmatex">\(O(1/N)\)</span> CIC spreading discretization error.)</em></p>
</li>
</ol>
</li>
</ul>
<hr />
<h2 id="output">Output<a class="headerlink" href="#output" title="Permanent link">&para;</a></h2>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>ROOT_DIR:<span class="w"> </span>/xxxxx/hexapic
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>HEXAPIC:<span class="w">  </span>/xxxxx/hexapic/source/HEXAPIC
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>NPROCS:<span class="w">   </span><span class="nv">1</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="o">=======================================================================================================</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="w">                                    </span>HEXAPIC<span class="w"> </span>PHYSICS<span class="w"> </span>VALIDATION<span class="w"> </span>SUITE<span class="w">                                   </span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="w">                 </span>Date:<span class="w"> </span><span class="m">2026</span>-02-18<span class="w"> </span><span class="m">14</span>:25<span class="w"> </span><span class="p">|</span><span class="w"> </span>Host:<span class="w"> </span>xxxxxx<span class="w"> </span><span class="p">|</span><span class="w"> </span>Procs:<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>Commit:<span class="w"> </span><span class="nv">8fc15a8</span><span class="w">                 </span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="o">=======================================================================================================</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>-------------------------------------------------------------------------------------------------------
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="w">                                         </span>PARTICLE<span class="w"> </span>PUSHER<span class="w"> </span>TESTS<span class="w">                                         </span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>-------------------------------------------------------------------------------------------------------
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="o">[</span>TEST<span class="w"> </span><span class="m">01</span><span class="o">]</span><span class="w"> </span>In-Plane<span class="w"> </span>Larmor<span class="w"> </span>Orbit
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="w">   </span>Context:<span class="w"> </span><span class="nv">B</span><span class="o">=</span><span class="m">0</span>.1T,<span class="w"> </span><span class="nv">v</span><span class="o">=</span>1e+06<span class="w"> </span>m/s,<span class="w"> </span><span class="nv">dt</span><span class="o">=</span>1ps,<span class="w"> </span><span class="nv">Steps</span><span class="o">=</span><span class="m">1071</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="w">   </span>----------------------------------------------------------------------------------------------------
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="w">   </span>METRIC<span class="w">                              </span>MEASURED<span class="w">        </span>EXPECTED<span class="w">         </span>ERROR<span class="w">       </span>MAX<span class="w"> </span>ERR<span class="w">   </span>STATUS
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="w">   </span>----------------------------------------------------------------------------------------------------
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="w">   </span>Energy<span class="w"> </span>Conservation<span class="w">                 </span><span class="m">1</span>.16e-33<span class="w">        </span><span class="m">0</span>.00e+00<span class="w">      </span><span class="m">1</span>.16e-33<span class="w">      </span><span class="m">4</span>.20e-14<span class="w">   </span><span class="o">[</span>PASS<span class="o">]</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="w">   </span>4R<span class="w"> </span>Separation<span class="w">                     </span><span class="m">2</span>.2802e-04<span class="w">      </span><span class="m">2</span>.2743e-04<span class="w">    </span><span class="m">5</span>.9871e-07<span class="w">    </span><span class="m">1</span>.1725e-06<span class="w">   </span><span class="o">[</span>PASS<span class="o">]</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="w">   </span>Y-projection<span class="w"> </span>trajectory<span class="w">           </span><span class="m">1</span>.1373e-04<span class="w">      </span><span class="m">1</span>.1371e-04<span class="w">    </span><span class="m">1</span>.9311e-08<span class="w">    </span><span class="m">2</span>.9314e-07<span class="w">   </span><span class="o">[</span>PASS<span class="o">]</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="w">   </span>Z-Axis<span class="w"> </span>Drift<span class="w">                        </span><span class="m">0</span>.00e+00<span class="w">        </span><span class="m">0</span>.00e+00<span class="w">      </span><span class="m">0</span>.00e+00<span class="w">      </span><span class="m">2</span>.39e-18<span class="w">   </span><span class="o">[</span>PASS<span class="o">]</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="w">   </span>----------------------------------------------------------------------------------------------------
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="w">   </span>Result:<span class="w"> </span>OK<span class="w">  </span>Time:<span class="w"> </span><span class="m">7</span>.62s
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="o">[</span>TEST<span class="w"> </span><span class="m">02</span><span class="o">]</span><span class="w"> </span>3V<span class="w"> </span>Larmor<span class="w"> </span>Orbit
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="w">   </span>Context:<span class="w"> </span><span class="nv">B_y</span><span class="o">=</span><span class="m">0</span>.1T,<span class="w"> </span><span class="nv">v_z</span><span class="o">=</span>1e+06<span class="w"> </span>m/s,<span class="w"> </span>3D<span class="w"> </span>Rotation<span class="w"> </span>Check
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="w">   </span>----------------------------------------------------------------------------------------------------
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a><span class="w">   </span>METRIC<span class="w">                              </span>MEASURED<span class="w">        </span>EXPECTED<span class="w">         </span>ERROR<span class="w">       </span>MAX<span class="w"> </span>ERR<span class="w">   </span>STATUS
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a><span class="w">   </span>----------------------------------------------------------------------------------------------------
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a><span class="w">   </span>Energy<span class="w"> </span>Conservation<span class="w">                 </span><span class="m">6</span>.74e-34<span class="w">        </span><span class="m">0</span>.00e+00<span class="w">      </span><span class="m">6</span>.74e-34<span class="w">      </span><span class="m">1</span>.88e-14<span class="w">   </span><span class="o">[</span>PASS<span class="o">]</span>
</span><span id="__span-0-32"><a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a><span class="w">   </span>X-Projection<span class="w"> </span>Trajectory<span class="w">           </span><span class="m">1</span>.1370e-04<span class="w">      </span><span class="m">1</span>.1371e-04<span class="w">    </span><span class="m">1</span>.0182e-08<span class="w">    </span><span class="m">2</span>.9314e-07<span class="w">   </span><span class="o">[</span>PASS<span class="o">]</span>
</span><span id="__span-0-33"><a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a><span class="w">   </span>Y-Axis<span class="w"> </span>Drift<span class="w">                        </span><span class="m">0</span>.00e+00<span class="w">        </span><span class="m">0</span>.00e+00<span class="w">      </span><span class="m">0</span>.00e+00<span class="w">      </span><span class="m">1</span>.07e-18<span class="w">   </span><span class="o">[</span>PASS<span class="o">]</span>
</span><span id="__span-0-34"><a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a><span class="w">   </span>----------------------------------------------------------------------------------------------------
</span><span id="__span-0-35"><a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a><span class="w">   </span>Result:<span class="w"> </span>OK<span class="w">  </span>Time:<span class="w"> </span><span class="m">2</span>.64s
</span><span id="__span-0-36"><a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a>
</span><span id="__span-0-37"><a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a><span class="o">[</span>TEST<span class="w"> </span><span class="m">03</span><span class="o">]</span><span class="w"> </span>ExB<span class="w"> </span>Drift
</span><span id="__span-0-38"><a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a><span class="w">   </span>Context:<span class="w"> </span><span class="nv">E</span><span class="o">=</span>-1e+04<span class="w"> </span>V/m,<span class="w"> </span><span class="nv">B</span><span class="o">=</span><span class="m">0</span>.1T,<span class="w"> </span>Expected<span class="w"> </span><span class="nv">v_drift</span><span class="o">=</span>1e+05<span class="w"> </span>m/s
</span><span id="__span-0-39"><a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a><span class="w">   </span>----------------------------------------------------------------------------------------------------
</span><span id="__span-0-40"><a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a><span class="w">   </span>METRIC<span class="w">                              </span>MEASURED<span class="w">        </span>EXPECTED<span class="w">         </span>ERROR<span class="w">       </span>MAX<span class="w"> </span>ERR<span class="w">   </span>STATUS
</span><span id="__span-0-41"><a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a><span class="w">   </span>----------------------------------------------------------------------------------------------------
</span><span id="__span-0-42"><a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a><span class="w">   </span>Hamiltonian<span class="w"> </span>Conservation<span class="w">            </span><span class="m">2</span>.10e-22<span class="w">        </span><span class="m">0</span>.00e+00<span class="w">      </span><span class="m">2</span>.10e-22<span class="w">      </span><span class="m">1</span>.87e-19<span class="w">   </span><span class="o">[</span>PASS<span class="o">]</span>
</span><span id="__span-0-43"><a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a><span class="w">   </span>Drift<span class="w"> </span>Velocity<span class="w">                    </span><span class="m">1</span>.0023e+05<span class="w">      </span><span class="m">1</span>.0000e+05<span class="w">    </span><span class="m">2</span>.3437e+02<span class="w">    </span><span class="m">3</span>.8668e+03<span class="w">   </span><span class="o">[</span>PASS<span class="o">]</span>
</span><span id="__span-0-44"><a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a><span class="w">   </span>----------------------------------------------------------------------------------------------------
</span><span id="__span-0-45"><a id="__codelineno-0-45" name="__codelineno-0-45" href="#__codelineno-0-45"></a><span class="w">   </span>Result:<span class="w"> </span>OK<span class="w">  </span>Time:<span class="w"> </span><span class="m">2</span>.29s
</span><span id="__span-0-46"><a id="__codelineno-0-46" name="__codelineno-0-46" href="#__codelineno-0-46"></a>
</span><span id="__span-0-47"><a id="__codelineno-0-47" name="__codelineno-0-47" href="#__codelineno-0-47"></a>-------------------------------------------------------------------------------------------------------
</span><span id="__span-0-48"><a id="__codelineno-0-48" name="__codelineno-0-48" href="#__codelineno-0-48"></a><span class="w">                                           </span>FIELD<span class="w"> </span>SOLVER<span class="w"> </span>TESTS<span class="w">                                          </span>
</span><span id="__span-0-49"><a id="__codelineno-0-49" name="__codelineno-0-49" href="#__codelineno-0-49"></a>-------------------------------------------------------------------------------------------------------
</span><span id="__span-0-50"><a id="__codelineno-0-50" name="__codelineno-0-50" href="#__codelineno-0-50"></a>
</span><span id="__span-0-51"><a id="__codelineno-0-51" name="__codelineno-0-51" href="#__codelineno-0-51"></a><span class="o">[</span>TEST<span class="w"> </span><span class="m">04</span><span class="o">]</span><span class="w"> </span>Mixed<span class="w"> </span>Boundaries
</span><span id="__span-0-52"><a id="__codelineno-0-52" name="__codelineno-0-52" href="#__codelineno-0-52"></a><span class="w">   </span>Context:<span class="w"> </span>Dirichlet<span class="w"> </span>Y,<span class="w"> </span>Neumann<span class="w"> </span>X
</span><span id="__span-0-53"><a id="__codelineno-0-53" name="__codelineno-0-53" href="#__codelineno-0-53"></a><span class="w">   </span>----------------------------------------------------------------------------------------------------
</span><span id="__span-0-54"><a id="__codelineno-0-54" name="__codelineno-0-54" href="#__codelineno-0-54"></a><span class="w">   </span>METRIC<span class="w">                              </span>MEASURED<span class="w">        </span>EXPECTED<span class="w">         </span>ERROR<span class="w">       </span>MAX<span class="w"> </span>ERR<span class="w">   </span>STATUS
</span><span id="__span-0-55"><a id="__codelineno-0-55" name="__codelineno-0-55" href="#__codelineno-0-55"></a><span class="w">   </span>----------------------------------------------------------------------------------------------------
</span><span id="__span-0-56"><a id="__codelineno-0-56" name="__codelineno-0-56" href="#__codelineno-0-56"></a><span class="w">   </span>Boundary<span class="w"> </span>Integrity<span class="w">                  </span><span class="m">0</span>.00e+00<span class="w">        </span><span class="m">0</span>.00e+00<span class="w">      </span><span class="m">0</span>.00e+00<span class="w">      </span><span class="m">2</span>.22e-14<span class="w">   </span><span class="o">[</span>PASS<span class="o">]</span>
</span><span id="__span-0-57"><a id="__codelineno-0-57" name="__codelineno-0-57" href="#__codelineno-0-57"></a><span class="w">   </span>Field<span class="w"> </span>Uniformity<span class="w">                  </span><span class="m">3</span>.9426e-02<span class="w">        </span><span class="m">0</span>.00e+00<span class="w">    </span><span class="m">3</span>.9426e-02<span class="w">    </span><span class="m">2</span>.0000e-01<span class="w">   </span><span class="o">[</span>PASS<span class="o">]</span>
</span><span id="__span-0-58"><a id="__codelineno-0-58" name="__codelineno-0-58" href="#__codelineno-0-58"></a><span class="w">   </span>----------------------------------------------------------------------------------------------------
</span><span id="__span-0-59"><a id="__codelineno-0-59" name="__codelineno-0-59" href="#__codelineno-0-59"></a><span class="w">   </span>Result:<span class="w"> </span>OK<span class="w">  </span>Time:<span class="w"> </span><span class="m">0</span>.01s
</span><span id="__span-0-60"><a id="__codelineno-0-60" name="__codelineno-0-60" href="#__codelineno-0-60"></a>
</span><span id="__span-0-61"><a id="__codelineno-0-61" name="__codelineno-0-61" href="#__codelineno-0-61"></a><span class="o">[</span>TEST<span class="w"> </span><span class="m">05</span><span class="o">]</span><span class="w"> </span>Fully<span class="w"> </span>Open<span class="w"> </span>Boundaries
</span><span id="__span-0-62"><a id="__codelineno-0-62" name="__codelineno-0-62" href="#__codelineno-0-62"></a><span class="w">   </span>Context:<span class="w"> </span>All<span class="w"> </span>Neumann,<span class="w"> </span>Neutral<span class="w"> </span>Dipole
</span><span id="__span-0-63"><a id="__codelineno-0-63" name="__codelineno-0-63" href="#__codelineno-0-63"></a><span class="w">   </span>----------------------------------------------------------------------------------------------------
</span><span id="__span-0-64"><a id="__codelineno-0-64" name="__codelineno-0-64" href="#__codelineno-0-64"></a><span class="w">   </span>METRIC<span class="w">                              </span>MEASURED<span class="w">        </span>EXPECTED<span class="w">         </span>ERROR<span class="w">       </span>MAX<span class="w"> </span>ERR<span class="w">   </span>STATUS
</span><span id="__span-0-65"><a id="__codelineno-0-65" name="__codelineno-0-65" href="#__codelineno-0-65"></a><span class="w">   </span>----------------------------------------------------------------------------------------------------
</span><span id="__span-0-66"><a id="__codelineno-0-66" name="__codelineno-0-66" href="#__codelineno-0-66"></a><span class="w">   </span>Boundary<span class="w"> </span>Flux<span class="w"> </span>Leakage<span class="w">             </span><span class="m">4</span>.4524e+02<span class="w">        </span><span class="m">0</span>.00e+00<span class="w">    </span><span class="m">4</span>.4524e+02<span class="w">    </span><span class="m">1</span>.5967e+04<span class="w">   </span><span class="o">[</span>PASS<span class="o">]</span>
</span><span id="__span-0-67"><a id="__codelineno-0-67" name="__codelineno-0-67" href="#__codelineno-0-67"></a><span class="w">   </span>----------------------------------------------------------------------------------------------------
</span><span id="__span-0-68"><a id="__codelineno-0-68" name="__codelineno-0-68" href="#__codelineno-0-68"></a><span class="w">   </span>Result:<span class="w"> </span>OK<span class="w">  </span>Time:<span class="w"> </span><span class="m">0</span>.01s
</span><span id="__span-0-69"><a id="__codelineno-0-69" name="__codelineno-0-69" href="#__codelineno-0-69"></a>
</span><span id="__span-0-70"><a id="__codelineno-0-70" name="__codelineno-0-70" href="#__codelineno-0-70"></a><span class="o">[</span>TEST<span class="w"> </span><span class="m">06</span><span class="o">]</span><span class="w"> </span>Closed<span class="w"> </span>Metal<span class="w"> </span>Box
</span><span id="__span-0-71"><a id="__codelineno-0-71" name="__codelineno-0-71" href="#__codelineno-0-71"></a><span class="w">   </span>Context:<span class="w"> </span>All<span class="w"> </span><span class="nv">phi</span><span class="o">=</span><span class="m">0</span>,<span class="w"> </span>Centered<span class="w"> </span>Charge
</span><span id="__span-0-72"><a id="__codelineno-0-72" name="__codelineno-0-72" href="#__codelineno-0-72"></a><span class="w">   </span>----------------------------------------------------------------------------------------------------
</span><span id="__span-0-73"><a id="__codelineno-0-73" name="__codelineno-0-73" href="#__codelineno-0-73"></a><span class="w">   </span>METRIC<span class="w">                              </span>MEASURED<span class="w">        </span>EXPECTED<span class="w">         </span>ERROR<span class="w">       </span>MAX<span class="w"> </span>ERR<span class="w">   </span>STATUS
</span><span id="__span-0-74"><a id="__codelineno-0-74" name="__codelineno-0-74" href="#__codelineno-0-74"></a><span class="w">   </span>----------------------------------------------------------------------------------------------------
</span><span id="__span-0-75"><a id="__codelineno-0-75" name="__codelineno-0-75" href="#__codelineno-0-75"></a><span class="w">   </span>Boundary<span class="w"> </span>Zero<span class="w"> </span>Check<span class="w">                 </span><span class="m">0</span>.00e+00<span class="w">        </span><span class="m">0</span>.00e+00<span class="w">      </span><span class="m">0</span>.00e+00<span class="w">      </span><span class="m">2</span>.22e-15<span class="w">   </span><span class="o">[</span>PASS<span class="o">]</span>
</span><span id="__span-0-76"><a id="__codelineno-0-76" name="__codelineno-0-76" href="#__codelineno-0-76"></a><span class="w">   </span>Symmetry<span class="w"> </span>Error<span class="w">                    </span><span class="m">1</span>.8462e-02<span class="w">        </span><span class="m">0</span>.00e+00<span class="w">    </span><span class="m">1</span>.8462e-02<span class="w">    </span><span class="m">6</span>.0076e-01<span class="w">   </span><span class="o">[</span>PASS<span class="o">]</span>
</span><span id="__span-0-77"><a id="__codelineno-0-77" name="__codelineno-0-77" href="#__codelineno-0-77"></a><span class="w">   </span>----------------------------------------------------------------------------------------------------
</span><span id="__span-0-78"><a id="__codelineno-0-78" name="__codelineno-0-78" href="#__codelineno-0-78"></a><span class="w">   </span>Result:<span class="w"> </span>OK<span class="w">  </span>Time:<span class="w"> </span><span class="m">0</span>.02s
</span><span id="__span-0-79"><a id="__codelineno-0-79" name="__codelineno-0-79" href="#__codelineno-0-79"></a>
</span><span id="__span-0-80"><a id="__codelineno-0-80" name="__codelineno-0-80" href="#__codelineno-0-80"></a><span class="o">[</span>TEST<span class="w"> </span><span class="m">07</span><span class="o">]</span><span class="w"> </span>Periodic<span class="w"> </span>X<span class="w"> </span>Boundaries
</span><span id="__span-0-81"><a id="__codelineno-0-81" name="__codelineno-0-81" href="#__codelineno-0-81"></a><span class="w">   </span>Context:<span class="w"> </span>Periodic<span class="w"> </span>X,<span class="w"> </span>Neumann<span class="w"> </span>Y
</span><span id="__span-0-82"><a id="__codelineno-0-82" name="__codelineno-0-82" href="#__codelineno-0-82"></a><span class="w">   </span>----------------------------------------------------------------------------------------------------
</span><span id="__span-0-83"><a id="__codelineno-0-83" name="__codelineno-0-83" href="#__codelineno-0-83"></a><span class="w">   </span>METRIC<span class="w">                              </span>MEASURED<span class="w">        </span>EXPECTED<span class="w">         </span>ERROR<span class="w">       </span>MAX<span class="w"> </span>ERR<span class="w">   </span>STATUS
</span><span id="__span-0-84"><a id="__codelineno-0-84" name="__codelineno-0-84" href="#__codelineno-0-84"></a><span class="w">   </span>----------------------------------------------------------------------------------------------------
</span><span id="__span-0-85"><a id="__codelineno-0-85" name="__codelineno-0-85" href="#__codelineno-0-85"></a><span class="w">   </span>Periodicity<span class="w">                       </span><span class="m">1</span>.2711e+02<span class="w">        </span><span class="m">0</span>.00e+00<span class="w">    </span><span class="m">1</span>.2711e+02<span class="w">    </span><span class="m">6</span>.3732e+02<span class="w">   </span><span class="o">[</span>PASS<span class="o">]</span>
</span><span id="__span-0-86"><a id="__codelineno-0-86" name="__codelineno-0-86" href="#__codelineno-0-86"></a><span class="w">   </span>----------------------------------------------------------------------------------------------------
</span><span id="__span-0-87"><a id="__codelineno-0-87" name="__codelineno-0-87" href="#__codelineno-0-87"></a><span class="w">   </span>Result:<span class="w"> </span>OK<span class="w">  </span>Time:<span class="w"> </span><span class="m">0</span>.01s
</span><span id="__span-0-88"><a id="__codelineno-0-88" name="__codelineno-0-88" href="#__codelineno-0-88"></a>
</span><span id="__span-0-89"><a id="__codelineno-0-89" name="__codelineno-0-89" href="#__codelineno-0-89"></a><span class="o">[</span>TEST<span class="w"> </span><span class="m">08</span><span class="o">]</span><span class="w"> </span>Analytical<span class="w"> </span>Accuracy
</span><span id="__span-0-90"><a id="__codelineno-0-90" name="__codelineno-0-90" href="#__codelineno-0-90"></a><span class="w">   </span>Context:<span class="w"> </span>Line<span class="w"> </span>Charge<span class="w"> </span>vs<span class="w"> </span>ln
</span><span id="__span-0-91"><a id="__codelineno-0-91" name="__codelineno-0-91" href="#__codelineno-0-91"></a><span class="w">   </span>----------------------------------------------------------------------------------------------------
</span><span id="__span-0-92"><a id="__codelineno-0-92" name="__codelineno-0-92" href="#__codelineno-0-92"></a><span class="w">   </span>METRIC<span class="w">                              </span>MEASURED<span class="w">        </span>EXPECTED<span class="w">         </span>ERROR<span class="w">       </span>MAX<span class="w"> </span>ERR<span class="w">   </span>STATUS
</span><span id="__span-0-93"><a id="__codelineno-0-93" name="__codelineno-0-93" href="#__codelineno-0-93"></a><span class="w">   </span>----------------------------------------------------------------------------------------------------
</span><span id="__span-0-94"><a id="__codelineno-0-94" name="__codelineno-0-94" href="#__codelineno-0-94"></a><span class="w">   </span>Analytical<span class="w"> </span>Fit<span class="w">                    </span><span class="m">2</span>.0674e-04<span class="w">        </span><span class="m">0</span>.00e+00<span class="w">    </span><span class="m">2</span>.0674e-04<span class="w">    </span><span class="m">1</span>.1111e+00<span class="w">   </span><span class="o">[</span>PASS<span class="o">]</span>
</span><span id="__span-0-95"><a id="__codelineno-0-95" name="__codelineno-0-95" href="#__codelineno-0-95"></a><span class="w">   </span>----------------------------------------------------------------------------------------------------
</span><span id="__span-0-96"><a id="__codelineno-0-96" name="__codelineno-0-96" href="#__codelineno-0-96"></a><span class="w">   </span>Result:<span class="w"> </span>OK<span class="w">  </span>Time:<span class="w"> </span><span class="m">0</span>.01s
</span><span id="__span-0-97"><a id="__codelineno-0-97" name="__codelineno-0-97" href="#__codelineno-0-97"></a>
</span><span id="__span-0-98"><a id="__codelineno-0-98" name="__codelineno-0-98" href="#__codelineno-0-98"></a>-------------------------------------------------------------------------------------------------------
</span><span id="__span-0-99"><a id="__codelineno-0-99" name="__codelineno-0-99" href="#__codelineno-0-99"></a><span class="w">                                      </span>PARTICLE<span class="w"> </span>MESH<span class="w"> </span>COUPLING<span class="w"> </span>TESTS<span class="w">                                     </span>
</span><span id="__span-0-100"><a id="__codelineno-0-100" name="__codelineno-0-100" href="#__codelineno-0-100"></a>-------------------------------------------------------------------------------------------------------
</span><span id="__span-0-101"><a id="__codelineno-0-101" name="__codelineno-0-101" href="#__codelineno-0-101"></a>
</span><span id="__span-0-102"><a id="__codelineno-0-102" name="__codelineno-0-102" href="#__codelineno-0-102"></a><span class="o">[</span>TEST<span class="w"> </span><span class="m">09</span><span class="o">]</span><span class="w"> </span>Charge<span class="w"> </span>Deposition<span class="w"> </span><span class="p">&amp;</span><span class="w"> </span>Potential<span class="w"> </span>Topology
</span><span id="__span-0-103"><a id="__codelineno-0-103" name="__codelineno-0-103" href="#__codelineno-0-103"></a><span class="w">   </span>Context:<span class="w"> </span>32x32,<span class="w"> </span><span class="nv">L</span><span class="o">=</span><span class="m">0</span>.001<span class="w"> </span>m,<span class="w"> </span>grounded<span class="w"> </span>box,<span class="w"> </span><span class="nv">Q_total</span><span class="o">=</span>-3.29e-13<span class="w"> </span>C
</span><span id="__span-0-104"><a id="__codelineno-0-104" name="__codelineno-0-104" href="#__codelineno-0-104"></a><span class="w">   </span>----------------------------------------------------------------------------------------------------
</span><span id="__span-0-105"><a id="__codelineno-0-105" name="__codelineno-0-105" href="#__codelineno-0-105"></a><span class="w">   </span>METRIC<span class="w">                              </span>MEASURED<span class="w">        </span>EXPECTED<span class="w">         </span>ERROR<span class="w">       </span>MAX<span class="w"> </span>ERR<span class="w">   </span>STATUS
</span><span id="__span-0-106"><a id="__codelineno-0-106" name="__codelineno-0-106" href="#__codelineno-0-106"></a><span class="w">   </span>----------------------------------------------------------------------------------------------------
</span><span id="__span-0-107"><a id="__codelineno-0-107" name="__codelineno-0-107" href="#__codelineno-0-107"></a><span class="w">   </span>Integrated<span class="w"> </span>Charge<span class="w"> </span>Conserv...<span class="w">        </span><span class="m">8</span>.18e-15<span class="w">        </span><span class="m">0</span>.00e+00<span class="w">      </span><span class="m">8</span>.18e-15<span class="w">      </span><span class="m">9</span>.96e-14<span class="w">   </span><span class="o">[</span>PASS<span class="o">]</span>
</span><span id="__span-0-108"><a id="__codelineno-0-108" name="__codelineno-0-108" href="#__codelineno-0-108"></a><span class="w">   </span>Symmetry<span class="w">                          </span><span class="m">1</span>.2351e-03<span class="w">        </span><span class="m">0</span>.00e+00<span class="w">    </span><span class="m">1</span>.2351e-03<span class="w">    </span><span class="m">3</span>.2676e-03<span class="w">   </span><span class="o">[</span>PASS<span class="o">]</span>
</span><span id="__span-0-109"><a id="__codelineno-0-109" name="__codelineno-0-109" href="#__codelineno-0-109"></a><span class="w">   </span>L2<span class="w"> </span>Profile<span class="w"> </span>Error<span class="w">                  </span><span class="m">4</span>.3836e-02<span class="w">        </span><span class="m">0</span>.00e+00<span class="w">    </span><span class="m">4</span>.3836e-02<span class="w">    </span><span class="m">3</span>.0304e-01<span class="w">   </span><span class="o">[</span>PASS<span class="o">]</span>
</span><span id="__span-0-110"><a id="__codelineno-0-110" name="__codelineno-0-110" href="#__codelineno-0-110"></a><span class="w">   </span>----------------------------------------------------------------------------------------------------
</span><span id="__span-0-111"><a id="__codelineno-0-111" name="__codelineno-0-111" href="#__codelineno-0-111"></a><span class="w">   </span>Result:<span class="w"> </span>OK<span class="w">  </span>Time:<span class="w"> </span><span class="m">2</span>.11s
</span><span id="__span-0-112"><a id="__codelineno-0-112" name="__codelineno-0-112" href="#__codelineno-0-112"></a>
</span><span id="__span-0-113"><a id="__codelineno-0-113" name="__codelineno-0-113" href="#__codelineno-0-113"></a><span class="o">[</span>TEST<span class="w"> </span><span class="m">10</span><span class="o">]</span><span class="w"> </span>Field<span class="w"> </span>Interpolation
</span><span id="__span-0-114"><a id="__codelineno-0-114" name="__codelineno-0-114" href="#__codelineno-0-114"></a><span class="w">   </span>Context:<span class="w"> </span>Capacitor<span class="w"> </span><span class="nv">dV</span><span class="o">=</span>20V,<span class="w"> </span><span class="nv">L</span><span class="o">=</span><span class="m">0</span>.001m
</span><span id="__span-0-115"><a id="__codelineno-0-115" name="__codelineno-0-115" href="#__codelineno-0-115"></a><span class="w">   </span>----------------------------------------------------------------------------------------------------
</span><span id="__span-0-116"><a id="__codelineno-0-116" name="__codelineno-0-116" href="#__codelineno-0-116"></a><span class="w">   </span>METRIC<span class="w">                              </span>MEASURED<span class="w">        </span>EXPECTED<span class="w">         </span>ERROR<span class="w">       </span>MAX<span class="w"> </span>ERR<span class="w">   </span>STATUS
</span><span id="__span-0-117"><a id="__codelineno-0-117" name="__codelineno-0-117" href="#__codelineno-0-117"></a><span class="w">   </span>----------------------------------------------------------------------------------------------------
</span><span id="__span-0-118"><a id="__codelineno-0-118" name="__codelineno-0-118" href="#__codelineno-0-118"></a><span class="w">   </span>Acceleration<span class="w"> </span>Accuracy<span class="w">             </span><span class="m">4</span>.3808e+13<span class="w">        </span><span class="m">0</span>.00e+00<span class="w">    </span><span class="m">4</span>.3808e+13<span class="w">    </span><span class="m">1</span>.0993e+15<span class="w">   </span><span class="o">[</span>PASS<span class="o">]</span>
</span><span id="__span-0-119"><a id="__codelineno-0-119" name="__codelineno-0-119" href="#__codelineno-0-119"></a><span class="w">   </span>----------------------------------------------------------------------------------------------------
</span><span id="__span-0-120"><a id="__codelineno-0-120" name="__codelineno-0-120" href="#__codelineno-0-120"></a><span class="w">   </span>Result:<span class="w"> </span>OK<span class="w">  </span>Time:<span class="w"> </span><span class="m">2</span>.06s
</span><span id="__span-0-121"><a id="__codelineno-0-121" name="__codelineno-0-121" href="#__codelineno-0-121"></a>
</span><span id="__span-0-122"><a id="__codelineno-0-122" name="__codelineno-0-122" href="#__codelineno-0-122"></a><span class="o">[</span>TEST<span class="w"> </span><span class="m">11</span><span class="o">]</span><span class="w"> </span>Self-Force<span class="w"> </span>Stability
</span><span id="__span-0-123"><a id="__codelineno-0-123" name="__codelineno-0-123" href="#__codelineno-0-123"></a><span class="w">   </span>Context:<span class="w"> </span>Stationary<span class="w"> </span>particle,<span class="w"> </span>Centered
</span><span id="__span-0-124"><a id="__codelineno-0-124" name="__codelineno-0-124" href="#__codelineno-0-124"></a><span class="w">   </span>----------------------------------------------------------------------------------------------------
</span><span id="__span-0-125"><a id="__codelineno-0-125" name="__codelineno-0-125" href="#__codelineno-0-125"></a><span class="w">   </span>METRIC<span class="w">                              </span>MEASURED<span class="w">        </span>EXPECTED<span class="w">         </span>ERROR<span class="w">       </span>MAX<span class="w"> </span>ERR<span class="w">   </span>STATUS
</span><span id="__span-0-126"><a id="__codelineno-0-126" name="__codelineno-0-126" href="#__codelineno-0-126"></a><span class="w">   </span>----------------------------------------------------------------------------------------------------
</span><span id="__span-0-127"><a id="__codelineno-0-127" name="__codelineno-0-127" href="#__codelineno-0-127"></a><span class="w">   </span>Parasitic<span class="w"> </span>Displacement<span class="w">            </span><span class="m">1</span>.6419e-04<span class="w">        </span><span class="m">0</span>.00e+00<span class="w">    </span><span class="m">1</span>.6419e-04<span class="w">    </span><span class="m">6</span>.2500e-03<span class="w">   </span><span class="o">[</span>PASS<span class="o">]</span>
</span><span id="__span-0-128"><a id="__codelineno-0-128" name="__codelineno-0-128" href="#__codelineno-0-128"></a><span class="w">   </span>----------------------------------------------------------------------------------------------------
</span><span id="__span-0-129"><a id="__codelineno-0-129" name="__codelineno-0-129" href="#__codelineno-0-129"></a><span class="w">   </span>Result:<span class="w"> </span>OK<span class="w">  </span>Time:<span class="w"> </span><span class="m">2</span>.06s
</span><span id="__span-0-130"><a id="__codelineno-0-130" name="__codelineno-0-130" href="#__codelineno-0-130"></a>
</span><span id="__span-0-131"><a id="__codelineno-0-131" name="__codelineno-0-131" href="#__codelineno-0-131"></a><span class="o">[</span>TEST<span class="w"> </span><span class="m">12</span><span class="o">]</span><span class="w"> </span>Current<span class="w"> </span>Deposition
</span><span id="__span-0-132"><a id="__codelineno-0-132" name="__codelineno-0-132" href="#__codelineno-0-132"></a><span class="w">   </span>Context:<span class="w"> </span>Moving<span class="w"> </span>particle,<span class="w"> </span>Gauss<span class="w"> </span>law<span class="w"> </span>charge<span class="w"> </span>check
</span><span id="__span-0-133"><a id="__codelineno-0-133" name="__codelineno-0-133" href="#__codelineno-0-133"></a><span class="w">   </span>----------------------------------------------------------------------------------------------------
</span><span id="__span-0-134"><a id="__codelineno-0-134" name="__codelineno-0-134" href="#__codelineno-0-134"></a><span class="w">   </span>METRIC<span class="w">                              </span>MEASURED<span class="w">        </span>EXPECTED<span class="w">         </span>ERROR<span class="w">       </span>MAX<span class="w"> </span>ERR<span class="w">   </span>STATUS
</span><span id="__span-0-135"><a id="__codelineno-0-135" name="__codelineno-0-135" href="#__codelineno-0-135"></a><span class="w">   </span>----------------------------------------------------------------------------------------------------
</span><span id="__span-0-136"><a id="__codelineno-0-136" name="__codelineno-0-136" href="#__codelineno-0-136"></a><span class="w">   </span>Charge<span class="w"> </span>Conservation<span class="w">                 </span><span class="m">3</span>.02e-17<span class="w">        </span><span class="m">0</span>.00e+00<span class="w">      </span><span class="m">3</span>.02e-17<span class="w">      </span><span class="m">9</span>.71e-14<span class="w">   </span><span class="o">[</span>PASS<span class="o">]</span>
</span><span id="__span-0-137"><a id="__codelineno-0-137" name="__codelineno-0-137" href="#__codelineno-0-137"></a><span class="w">   </span>----------------------------------------------------------------------------------------------------
</span><span id="__span-0-138"><a id="__codelineno-0-138" name="__codelineno-0-138" href="#__codelineno-0-138"></a><span class="w">   </span>Result:<span class="w"> </span>OK<span class="w">  </span>Time:<span class="w"> </span><span class="m">2</span>.04s
</span><span id="__span-0-139"><a id="__codelineno-0-139" name="__codelineno-0-139" href="#__codelineno-0-139"></a>
</span><span id="__span-0-140"><a id="__codelineno-0-140" name="__codelineno-0-140" href="#__codelineno-0-140"></a><span class="o">=======================================================================================================</span>
</span><span id="__span-0-141"><a id="__codelineno-0-141" name="__codelineno-0-141" href="#__codelineno-0-141"></a><span class="w">                                                </span><span class="nv">SUMMARY</span><span class="w">                                                </span>
</span><span id="__span-0-142"><a id="__codelineno-0-142" name="__codelineno-0-142" href="#__codelineno-0-142"></a><span class="o">=======================================================================================================</span>
</span><span id="__span-0-143"><a id="__codelineno-0-143" name="__codelineno-0-143" href="#__codelineno-0-143"></a>PARTICLE<span class="w"> </span>PUSHER
</span><span id="__span-0-144"><a id="__codelineno-0-144" name="__codelineno-0-144" href="#__codelineno-0-144"></a><span class="w">  </span><span class="m">1</span>.<span class="w"> </span>In-Plane<span class="w"> </span>Larmor<span class="w"> </span>Orbit<span class="w">               </span><span class="o">[</span>PASS<span class="o">]</span>
</span><span id="__span-0-145"><a id="__codelineno-0-145" name="__codelineno-0-145" href="#__codelineno-0-145"></a><span class="w">  </span><span class="m">2</span>.<span class="w"> </span>3V<span class="w"> </span>Larmor<span class="w"> </span>Orbit<span class="w">                     </span><span class="o">[</span>PASS<span class="o">]</span>
</span><span id="__span-0-146"><a id="__codelineno-0-146" name="__codelineno-0-146" href="#__codelineno-0-146"></a><span class="w">  </span><span class="m">3</span>.<span class="w"> </span>ExB<span class="w"> </span>Drift<span class="w">                           </span><span class="o">[</span>PASS<span class="o">]</span>
</span><span id="__span-0-147"><a id="__codelineno-0-147" name="__codelineno-0-147" href="#__codelineno-0-147"></a>
</span><span id="__span-0-148"><a id="__codelineno-0-148" name="__codelineno-0-148" href="#__codelineno-0-148"></a>FIELD<span class="w"> </span>SOLVER
</span><span id="__span-0-149"><a id="__codelineno-0-149" name="__codelineno-0-149" href="#__codelineno-0-149"></a><span class="w">  </span><span class="m">4</span>.<span class="w"> </span>Mixed<span class="w"> </span>Boundaries<span class="w">                    </span><span class="o">[</span>PASS<span class="o">]</span>
</span><span id="__span-0-150"><a id="__codelineno-0-150" name="__codelineno-0-150" href="#__codelineno-0-150"></a><span class="w">  </span><span class="m">5</span>.<span class="w"> </span>Fully<span class="w"> </span>Open<span class="w"> </span>Boundaries<span class="w">               </span><span class="o">[</span>PASS<span class="o">]</span>
</span><span id="__span-0-151"><a id="__codelineno-0-151" name="__codelineno-0-151" href="#__codelineno-0-151"></a><span class="w">  </span><span class="m">6</span>.<span class="w"> </span>Closed<span class="w"> </span>Metal<span class="w"> </span>Box<span class="w">                    </span><span class="o">[</span>PASS<span class="o">]</span>
</span><span id="__span-0-152"><a id="__codelineno-0-152" name="__codelineno-0-152" href="#__codelineno-0-152"></a><span class="w">  </span><span class="m">7</span>.<span class="w"> </span>Periodic<span class="w"> </span>X<span class="w"> </span>Boundaries<span class="w">               </span><span class="o">[</span>PASS<span class="o">]</span>
</span><span id="__span-0-153"><a id="__codelineno-0-153" name="__codelineno-0-153" href="#__codelineno-0-153"></a><span class="w">  </span><span class="m">8</span>.<span class="w"> </span>Analytical<span class="w"> </span>Accuracy<span class="w">                 </span><span class="o">[</span>PASS<span class="o">]</span>
</span><span id="__span-0-154"><a id="__codelineno-0-154" name="__codelineno-0-154" href="#__codelineno-0-154"></a>
</span><span id="__span-0-155"><a id="__codelineno-0-155" name="__codelineno-0-155" href="#__codelineno-0-155"></a>PARTICLE<span class="w"> </span>MESH<span class="w"> </span>COUPLING
</span><span id="__span-0-156"><a id="__codelineno-0-156" name="__codelineno-0-156" href="#__codelineno-0-156"></a><span class="w">  </span><span class="m">9</span>.<span class="w"> </span>Charge<span class="w"> </span>Deposition<span class="w"> </span><span class="p">&amp;</span><span class="w"> </span>Potential<span class="w"> </span>...<span class="w">   </span><span class="o">[</span>PASS<span class="o">]</span>
</span><span id="__span-0-157"><a id="__codelineno-0-157" name="__codelineno-0-157" href="#__codelineno-0-157"></a><span class="w">  </span><span class="m">10</span>.<span class="w"> </span>Field<span class="w"> </span>Interpolation<span class="w">                 </span><span class="o">[</span>PASS<span class="o">]</span>
</span><span id="__span-0-158"><a id="__codelineno-0-158" name="__codelineno-0-158" href="#__codelineno-0-158"></a><span class="w">  </span><span class="m">11</span>.<span class="w"> </span>Self-Force<span class="w"> </span>Stability<span class="w">                </span><span class="o">[</span>PASS<span class="o">]</span>
</span><span id="__span-0-159"><a id="__codelineno-0-159" name="__codelineno-0-159" href="#__codelineno-0-159"></a><span class="w">  </span><span class="m">12</span>.<span class="w"> </span>Current<span class="w"> </span>Deposition<span class="w">                  </span><span class="o">[</span>PASS<span class="o">]</span>
</span><span id="__span-0-160"><a id="__codelineno-0-160" name="__codelineno-0-160" href="#__codelineno-0-160"></a>
</span><span id="__span-0-161"><a id="__codelineno-0-161" name="__codelineno-0-161" href="#__codelineno-0-161"></a>-------------------------------------------------------------------------------------------------------
</span><span id="__span-0-162"><a id="__codelineno-0-162" name="__codelineno-0-162" href="#__codelineno-0-162"></a>OVERALL:<span class="w"> </span>PASSED<span class="w"> </span><span class="o">(</span><span class="m">12</span>/12<span class="w"> </span>tests<span class="w"> </span>passed,<span class="w"> </span><span class="m">22</span>/22<span class="w"> </span>metrics<span class="o">)</span>
</span><span id="__span-0-163"><a id="__codelineno-0-163" name="__codelineno-0-163" href="#__codelineno-0-163"></a>Total<span class="w"> </span>Runtime:<span class="w"> </span><span class="m">20</span>.89s
</span><span id="__span-0-164"><a id="__codelineno-0-164" name="__codelineno-0-164" href="#__codelineno-0-164"></a><span class="o">=======================================================================================================</span>
</span></code></pre></div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../scaling/" class="btn btn-neutral float-left" title="Scaling"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../validation/" class="btn btn-neutral float-right" title="Validation">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
      <p>Copyright &copy; 2025 LeCAD-PEG</p>
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/LeCAD-PEG/HEXAPIC.git" class="fa fa-code-fork" style="color: #fcfcfc"> HEXAPIC</a>
        </span>
    
    
      <span><a href="../scaling/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../validation/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../javascripts/mathjax.js"></script>
      <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
